<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="./css/font_t20i9ofs3lt/iconfont.css">
    <link rel="stylesheet" href="./css/font_d72pqdvv4sg/iconfont.css">
    <link rel="stylesheet" href="./css/font_nzpr7n9pvu/iconfont.css">
    <style>
            .smallpic {
                width: 450px;
                height: 450px;
                border: 1px solid #ccc;
                position: relative;
            }
            .smallpic img{
                width: 450px;
                height: 450px;
            }
    
            .sf {
                background-color: orange;
                opacity: 0.3;
                position: absolute;
                left: 0;
                top: 0;
                visibility: hidden;
                /* visibility: hidden;隐藏元素方便获取尺寸，dispaly:none某些浏览器下面会出问题 */
                cursor: move;
            }
    
            .bf {
                width: 400px;
                height: 400px;
                left: 405px;top:0;z-index: 100;
                border: 1px solid #ccc;
                overflow: hidden;
                position: absolute;
                visibility: hidden;
            }
    
            .bigpic {
                width: 800px;
                height: 800px;
                position: absolute;
                left: 0;
                top: 0;
            }
        </style>
        <link rel="stylesheet" href="./css/first.css">
        <style>
        body{background: #fff !important;}
        .message{position: relative;float: right;}
        .gouwuche{position: absolute;right:-200px;top: 50px;background: pink;color: #fff;border: 1px solid #000;display: block;
        width: 100px;height: 40px;cursor:pointer;line-height: 40px;text-align: center}
        .gouwuche span{position: absolute;background: red;color: #fff;border-radius: 50%;width: 12px;height: 12px;
        line-height: 12px;font-size: 12px;text-align: center;top: 0;right: 0}
        .scale{float: left;position: relative;}
        </style>
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="./js/Cookie.js"></script>
</head>
<body>
    <div class="hearder">
        <div id="hearhtml"></div>
    </div>
    <div id="searchfirst">
    </div>

    <!-- 搜索 login 页面  -->
        <script type="text/javascript">
            //在js中引入
            $(document).ready(function () {
                $('#searchfirst').load('searchfirst.html');
            });
        </script>

<style>
    #goods_main{overflow: hidden;margin-bottom: 50px;}
    .main1_left{float: left;width: 950px;}
    .left_goods{height: 700px;border-right: 1px solid #ccc;padding-right: 10px; }
    .main1_message{width: 530px;height: 648px;float: right;}
    .main1_right{    padding: 10px 12px 2px 13px;width: 200px;height: 600px;background: green;float: right;}
    .smallpic{width: 400px;height: 400px;}
    .smallpic img{width: 400px;height: 400px;}
    .message .title{height: 20px;font-weight: 600;overflow: hidden;line-height: 20px;padding: 0 5px;}
     .message .title_adve{text-indent: 5px; font-size: 14px;color: #FF0036;}
     .main1_message .title_num{height: 65px;background: no-repeat url(../src/img/123.jpg);padding: 5px;
     margin-top: 15px;background-size: cover;}
     .goods_price{display: flex;flex-wrap: wrap;align-content: center;}
      #goods_main .original_price{height: 20px;font-size: 14px;}
      #goods_main .original_price .original_num{text-decoration:line-through;}
      #goods_main .new_price{height: 40px;}
      #goods_main .new_price p:nth-child(2){color: orangered;}
      #goods_main .new_price .num{font-size: 30px;font-weight: 600}
      #goods_main .goods_price p:nth-child(1){color: #444;width: 70px;font-size: 13px;}
      #goods_main .new_price P:nth-child(1){line-height: 40px;}
</style>
 <!-- 数据主要布局 -->
 <div id="goods_main" class="main1">
     <!-- 左邊 -->
     <div class="main1_left">
         <div class="left_goods">
            <div class="scale">
                <div class="smallpic">
                    <!--小图-->
                    <img>
                    <!--小放大镜-->
                    <div class="sf"></div>
                </div>
                <!--大放大镜-->
                <div class="bf">
                    <!--大图-->
                    <img alt="" class="bigpic">
                </div>
            </div>
             <div class="main1_message">
            <div class="message">
                <p class="title"></p>
                <p class="title_adve">前一百名送密碼鎖加箱貼</p>
                <div class="title_num">
                <div class="goods_price original_price">
                <p>价格</p><p>￥<span class="original_num">978.00-1258.00</span></p>
                </div>
                <div class="goods_price new_price">
                <p>促销价格</p><p>￥<span class="num"></span></p>
                </div>
                </div>
                <style>
                    .goods_text_message{height: 500px;font-size: 12px;}
                 #goods_main .goods_text_freight{height: 40px;display: flex;
                flex-wrap: wrap;align-items: center;border-bottom: 1px dashed #ccc;}
                #goods_main  .goods_text_span{width: 50px;margin-left: 7px;color: #ccc;display: inline-block}
                #goods_main .goods_text_webnuber{border-bottom: 1px dashed #ccc;height: 35px;
                display: flex;justify-content: center;align-items: center;}
                #goods_main .goods_text_webnuber  p{width: 33%;border-right: 1px dashed #ccc;height: 15px;text-align: center;
                color: #ccc;font-weight: 600;}
                #goods_main .goods_text_webnuber  p:nth-child(3){border: none}
                #goods_main .goods_text_webnuber span{color: orangered;display: inline-block;padding: 0 4px;}
                #goods_main .goods_text_webnuber .text_green{color: green;}
                .goods_text_size{display: flex;flex-wrap: wrap;
                    margin-top: 17px;
                }
                .goods_text_size .G_T_S_text{width: 430px;overflow: hidden;}
                .goods_text_size .G_T_S_text li{ float: left;text-align: center;margin: 0 5px 5px  0;
                display: flex;justify-content: center;align-items: center;height:31px;}
                .G_T_S_text li p{padding: 5px 9px;border: 1px solid #ccc;
                }
                .G_T_S_text li p:hover{border: 2px solid red; padding: 5px 8px;}
                .goods_text_size .goods_text_span{padding-top: 5px;}
                .goods_text_imgs{display: flex;flex-wrap: wrap;
                    margin-top: 17px;margin-bottom: 10px;}
                .G_T_S_color{height: 60px;width: 430px;overflow: hidden;border: 1px solid #ccc;}
                .goods_shopcar{height: 60px;display: flex;justify-content: center;align-items: center;}
                #goods_main .goods_shopcar .left,.right{background: #fff;box-shadow: none;display: inline-block;border: 1px solid #ccc;
                width:20px;height: 20px;line-height: 10px; text-align: center;}
                .goods_shopcar .goodsnumber{display: block;height: 37px;width: 33px;font-size: 15px;text-indent: 7px;}
                .goods_btn_lr{width: 20px;height:40px;margin:0 3px;}
                .btn_goods{width: 178px;height: 40px;text-align: center;background: pink;color:orangered;border: 1px solid orangered;
                font-size: 18px;line-height: 30px;margin: 10px 15px;cursor: pointer;}
                .btn_goods_div{width: 430px;margin-left: 42px;}
                .btn_goods_div .but{    background-color: #ff0036; border: 1px solid #ff0036; color: #fff;}
                </style>
                <div class="goods_text_message">
                    <div class="goods_text_freight">
                    <span class="goods_text_span">运费</span><p> <span class="goods_place">福建泉州</span>  至 杭州 <span></span> 快递:0.00 </p>
                    </div>
                    <div class="goods_text_webnuber">
                        <p>月销量<span class="goods_number">70</span></p>
                        <p>累计评论<span>2893</span></p>
                        <p>送天猫积分<span class="text_green">249</span>起</p>
                    </div>
                    <div class="goods_text_size">
                    <span class="goods_text_span">尺寸</span><div class="G_T_S_text">
                        <li><p>20寸登机箱</p></li>
                        <li><p>22寸专柜品质</p></li>
                        <li><p>24寸纯pc材质</p></li>
                        <li><p>26寸三年年保质</p></li>
                        <li><p>28寸大容量</p></li>
                    </div>
                    <div class="goods_text_imgs">
                    <span class="goods_text_span">颜色分类</span><div class="G_T_S_color"></div>
                    </div>
                    <span class="goods_text_span">数量</span> <div class="goods_shopcar">
                    <input type="text" value="1" class="goodsnumber">
                    <div class="goods_btn_lr">
                    <button class="left">-</button><button class="right">+</button> 
                    </div><span>件</span>
                </div>
               
                </div>
                <div class="btn_goods_div">
                        <button class="btn_goods">立即购买</button><button class="btn_goods but">加入购物车</button>
                       </div>
                </div>

                </div>
                </div>
                </div>
                </div>

       <!-- 右邊 -->
        <div class="main1_right"></div>


        </div>
  
       <!-- 屁股导入 -->
  <div id="footer"></div>
  
      <script type="text/javascript">
        $(document).ready(function () {
            $('#footer').load('foot.html');
        });
    </script>

   <script>


!function($){
       const smallpicSf = $(".smallpic img");
       const bigpic = $(".bf .bigpic");
       const message = $(".message .title");
       const num = $(".message .num");
       const goodsnumber = document.querySelector(".goodsnumber");
       const but = document.querySelector(".but");
       const gouwuche = $("#shopcar .num");
       const left= document.querySelector(".left");
       const right= document.querySelector(".right");
       const goods_number =$(".goods_number");
       const original_num = $(".original_num");
       const goods_place = $(".goods_place");
       leftAright();
       let cookie2 = new Cookiefn();
       const url = "http://10.31.162.16/";
       dataAdd();
       function dataAdd(){
  let sp =   window.location.search.substring(1);

//  通过点击传过来的 域名id  通过ajax 获取响应的商品数据 
    $.ajax({
        type:"post",
        url:url+"php/data/goods_select_id.php",
        dataType:"json",
        data:{
            sid:sp
        },success:function(data){
            console.log(data)
           smallpicSf.prop("src" ,data.goods_img)
           bigpic.prop("src" ,data.goods_img)
           message.html(data.goods_name);
           num.html(data.goods_price);
           goods_number.html(data.goods_number)
           original_num.html((data.goods_price-0.1+100.1).toFixed(2)+"--"+(data.goods_price-0.1+200).toFixed(2))
           goods_place.html(data.goods_prace)
        }
    })  
// 初始化小图标
 gouwuchejingru();

//  左右按钮点击事件
    but.addEventListener("click",(e)=>{
        if(cookie2.selectCookie('arrsid') && cookie2.selectCookie('arrnum')){
            let arrsid = cookie2.selectCookie('arrsid').split(",");
            let arrnum = cookie2.selectCookie('arrnum').split(",");
           
            if(arrsid.indexOf(sp)!==-1){
              
            arrnum[arrsid.indexOf(sp)] = parseInt(arrnum[arrsid.indexOf(sp)])+parseInt(goodsnumber.value);
            if(arrnum[arrsid.indexOf(sp)]>100)
            arrnum[arrsid.indexOf(sp)]=99;
        }else{
            arrsid.push(sp);
            arrnum.push(parseInt(goodsnumber.value));
        }
        cookie2.addCookie('arrsid',arrsid,100);
        cookie2.addCookie('arrnum',arrnum,100);
        }else{
            cookie2.addCookie('arrsid',new Array(`${sp}`),100) ;
            cookie2.addCookie('arrnum',new Array(`${parseInt(goodsnumber.value)}`),100) ;
         }

            
            // 小图标方法
            gouwuchejingru();

                
    });
}

//  购物车小图标方法    记录id数量
function gouwuchejingru(){

    //在js中引入
    $(document).ready(function () {
        $('#hearhtml').load('hear.html');
    });

    // console.log($("#hearhtml").children());
    if(cookie2.selectCookie('arrsid')){
    if(cookie2.selectCookie('arrsid').split(",").length==0){
        gouwuche.css("dispaly","none");
     }else{
        gouwuche.html(cookie2.selectCookie('arrsid').split(",").length) 
        gouwuche.css("dispaly","block");
     }
    }
}



//  左右按钮 修改数量方法   数量不超过99个 不少于1個 並不能輸入非数字的符号
function leftAright(){ 
     goodsnumber.oninput = e=>{
         e.target.value = e.target.value.replace(/[^0-9]/g,"");
         if(parseInt(e.target.value)<=0){
            e.target.value = 1;
         }else if(parseInt(e.target.value)>=99){
            e.target.value = 99;
         }
     }
    left.onclick = right.onclick = e=>{
     if($(e.target).hasClass("left")){
        goodsnumber.value = parseInt(goodsnumber.value)-1;
     }else{
        goodsnumber.value = parseInt(goodsnumber.value)+1;
     }
     if(parseInt(goodsnumber.value)<=0){
        goodsnumber.value = 1;
         }else if(parseInt(goodsnumber.value)>=99){
            goodsnumber.value = 99;
         }
    }
}
}(jQuery)



//  有问题 ！！！！！！！！！！！！
//  放大镜   类
 class Scale {
            constructor() {
                this.goods_main = document.querySelector("#goods_main");
                this.scale = document.querySelector('.scale');
                this.smallpic = document.querySelector('.smallpic');
                this.sf = document.querySelector('.sf');
                this.bigpic = document.querySelector('.bigpic');
                this.bf = document.querySelector('.bf');
            }
            init() {

  this.sf.style.width = this.smallpic.offsetWidth * this.bf.offsetWidth / this.bigpic.offsetWidth + 'px';
                    //2.鼠标移入求小放的尺寸。
  this.sf.style.height = this.smallpic.offsetHeight * this.bf.offsetHeight / this.bigpic.offsetHeight + 'px';
                   //3.比例，注意比例一定要大于1(放大操作)，一定大的比小的。
  this.bili = this.bigpic.offsetWidth / this.smallpic.offsetWidth; //1.鼠标移入移出小图，小放和大放会对应显示和隐藏。
                //  移入显示 
                this.smallpic.onmouseover = () => {
                    this.sf.style.visibility = 'visible';
                    this.bf.style.visibility = 'visible';
                    //4.鼠标移动的时候，小放跟随鼠标
                    this.smallpic.onmousemove = (ev) => {
                        var ev = ev || window.event;
                        this.move(ev);
                    }
                };

                // 一处隐藏
                this.smallpic.onmouseout = () => {
                    this.sf.style.visibility = 'hidden';
                    this.bf.style.visibility = 'hidden';
                };
            }
            move(ev) {
 
                let leftvalue = ev.pageX-this.scale.offsetLeft - this.sf.clientWidth/2;
                let topvalue = ev.pageY-this.scale.offsetTop - this.sf.clientHeight/2;
              
                if (leftvalue < 0) {
                    leftvalue = 0;
                } else if (leftvalue >= this.smallpic.clientWidth - this.sf.clientWidth) {
                    leftvalue = this.smallpic.clientWidth - this.sf.clientWidth;
                }
                if (topvalue < 0) {
                    topvalue = 0;
                } else if (topvalue >= this.smallpic.clientHeight - this.sf.clientHeight) {
                    topvalue = this.smallpic.clientHeight - this.sf.clientHeight;
                }
                this.sf.style.left = leftvalue + 'px';
                this.sf.style.top = topvalue + 'px';
                this.bigpic.style.left = -leftvalue * this.bili + 'px';
                this.bigpic.style.top = -topvalue * this.bili + 'px';
            }
        }
        new Scale().init();

    </script>

</body>
</html>